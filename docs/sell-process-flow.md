# 承兑商流程规范文档

## 1. 流程概述

### 1.1 基本流程
承兑商流程分为4个主要步骤：
1. 保证金确认
2. 等待美元汇款
3. 确认收款并释放USDT
4. 交易完成

### 1.2 保证金类型
- 0%保证金：订单生成前不锁定承兑商的账户中的USDT
- 100%保证金：交易前锁定承兑商钱包中的跟交易量相同的USDT

### 1.3 聊天功能
- 每个页面必须包含聊天入口
- 聊天入口跟其他按钮放在同一行

## 2. 详细流程说明

### 2.1 第一步：保证金确认
#### 页面文件
- `margin.html`：确认保证金协商
- `margin-waiting.html`：等待买方确认

#### 功能说明
1. 保证金确认页面（margin.html）
   - 查看买方提出的保证金比例和金额
   - 确认或修改保证金金额
   - 提交确认请求
   - 显示协商历史（如有）
   - 聊天入口

2. 等待确认页面（margin-waiting.html）
   - 显示等待状态
   - 提供取消选项
   - 聊天入口

#### 异常处理
- 金额输入错误
- 比例选择验证
- 协商超时
- 买方拒绝

#### 100%保证金特殊处理
1. 确认保证金比例时：
   - 系统自动检查钱包余额
   - 如果余额充足：
     - 自动锁定对应金额的USDT
     - 完成保证金比例确认
   - 如果余额不足：
     - 显示"余额不足，请补充钱包"
     - 提供快速充值入口
     - 引导从其他钱包转入USDT
     - 余额补充后自动锁定USDT

### 2.2 第二步：等待美元汇款
#### 页面文件
- `pay.html`：等待买方汇款

#### 功能说明
1. 等待汇款信息
   - 显示收款账户信息
   - 显示待收金额
   - 显示汇款截止时间
   - 聊天入口

2. 凭证审核
   - 查看买方上传的汇款凭证
   - 验证凭证有效性
   - 确认收款信息

3. 备注信息
   - 查看买方备注
   - 添加确认备注

#### 异常处理
- 凭证无效
- 汇款超时
- 买方取消
- 金额不符

### 2.3 第三步：确认收款并释放USDT
#### 页面文件
- `waiting-usdt.html`：确认收款并释放USDT

#### 功能说明
1. 100%保证金流程
   - 确认收到美元汇款
   - 系统自动释放已锁定的USDT
   - 显示释放进度
   - 聊天入口

2. 0%保证金流程
   - 确认收到美元汇款
   - 系统检查账户余额
   - 立即划转USDT
   - 余额不足等待补充

#### 异常处理
- 余额不足
- 释放失败
- 超时处理
- 网络异常

### 2.4 第四步：交易完成
#### 页面文件
- `complete.html`：交易完成页面

#### 功能说明
1. 交易详情展示
   - 交易金额
   - 保证金信息
   - 时间信息
   - 交易状态
   - 聊天入口

2. 后续操作
   - 继续交易
   - 发起投诉
   - 查看历史

#### 异常处理
- 交易异常
- 投诉处理
- 状态同步

## 3. 页面优化建议

### 3.1 margin.html 优化
- [ ] 优化保证金确认界面
- [ ] 增加金额验证
- [ ] 优化协商历史展示
- [ ] 添加常见问题提示
- [ ] 优化聊天引导
- [ ] 完善聊天入口样式

### 3.2 margin-waiting.html 优化
- [ ] 优化等待状态展示
- [ ] 添加预计等待时间
- [ ] 完善取消流程
- [ ] 增加状态更新提示
- [ ] 优化聊天入口位置

### 3.3 pay.html 优化
- [ ] 优化收款信息展示
- [ ] 完善凭证审核功能
- [ ] 添加审核指南
- [ ] 优化备注显示
- [ ] 优化聊天入口样式

### 3.4 waiting-usdt.html 优化
- [ ] 区分0%和100%保证金流程
- [ ] 优化余额不足提示
- [ ] 完善等待状态展示
- [ ] 添加自动刷新功能
- [ ] 优化聊天入口位置

### 3.5 complete.html 优化
- [ ] 优化交易详情展示
- [ ] 完善投诉入口
- [ ] 添加交易评价功能
- [ ] 优化继续交易流程
- [ ] 优化聊天入口样式 